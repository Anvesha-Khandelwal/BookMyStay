<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Complete Your Booking - BookMyStay</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link rel="stylesheet" href="style.css" />

<style>
:root {
  --accent:#4fd1e5;
  --accent-soft:rgba(79,209,229,0.25);
  --card-light:rgba(255,255,255,0.78);
  --bg-page:#fdf8f2;
  --text-dark:#2b3a2d;
  --text-sub:#4a5568;
  --text-muted:#718096;
  --radius:32px;
}

body.booking-page {
  margin:0;font-family:Poppins,sans-serif;
  background:var(--bg-page);color:var(--text-dark);
}

/* Layout */
.booking-section{padding:2rem 1.2rem 3rem;}
.booking-container {
  max-width:1020px;margin:auto;
  display:grid;grid-template-columns:1.3fr 1fr;gap:2rem;
}
@media(max-width:900px){.booking-container{grid-template-columns:1fr;}}

/* Summary card */
.booking-summary-card {
  background:#fff;padding:1.6rem;
  border-radius:var(--radius);box-shadow:0 12px 42px rgba(0,0,0,0.06);
  border:1.8px solid #edf2f7;position:sticky;top:86px;
  backdrop-filter:blur(14px);transition:0.3s;
}
.booking-summary-card:hover{box-shadow:0 18px 56px rgba(0,0,0,0.1);}

/* Bill items */
.booking-summary-title{font-size:1.45rem;font-weight:800;color:#567f63;margin-bottom:1rem;}
.booking-summary-item {
  display:flex;justify-content:space-between;
  padding:0.8rem 0;border-bottom:1.5px dashed var(--accent-soft);
  font-size:0.92rem;font-weight:700;color:var(--text-dark);
}
.booking-summary-total{
  margin-top:1rem;padding:1rem 0.7rem;border-radius:16px;
  background:var(--bg-secondary);border:2px solid var(--accent-soft);
  display:flex;justify-content:space-between;font-weight:800;
  align-items:center;
}
#bTotal{color:#567f63;font-size:1.45rem;}

/* Payment Card */
.payment-card{
  background:#fff;padding:1.6rem;border-radius:var(--radius);
  box-shadow:0 12px 42px rgba(0,0,0,0.06);
  border:1.8px solid #edf2f7;margin-top:2rem;
  animation:fadeUp 0.6s ease-out;
}
.payment-title{color:#567f63;font-size:1.35rem;font-weight:800;margin:0 0 1rem;}

/* Inputs */
input,select{
  width:100%;
  padding:1rem 1.2rem;border-radius:16px;
  border:2px solid rgba(0,0,0,0.06);
  font-size:0.92rem;font-weight:700;
  font-family:inherit;color:var(--text-dark);
  outline:none;transition:0.25s;margin-bottom:0.9rem;
  box-shadow:0 4px 16px rgba(0,0,0,0.015);
}
input:focus,select:focus{
  border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-soft);
}

/* Payment Options */
.pay-options{display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;margin:1.4rem 0 1.8rem;}
.pay-btn{
  display:flex;align-items:center;gap:0.5rem;justify-content:center;
  background:var(--bg-secondary);padding:0.8rem;border-radius:14px;
  border:2px solid rgba(0,0,0,0.05);
  font-weight:800;font-size:0.8rem;cursor:pointer;transition:0.3s;
  text-transform:uppercase;color:var(--text-dark);
}
.pay-btn:hover{transform:translateY(-4px);border-color:var(--accent);box-shadow:0 8px 28px var(--accent-soft);}
.pay-btn.selected{border-color:var(--accent);background:var(--accent);color:#fff;}

.booking-btn-submit{
  width:100%;
  background:var(--accent);color:#fff;border:none;padding:1rem;
  border-radius:16px;font-weight:800;cursor:pointer;
  box-shadow:0 6px 18px var(--accent-soft);transition:0.3s;
  text-transform:uppercase;letter-spacing:0.6px;
}
.booking-btn-submit:hover{opacity:0.88;transform:translateY(-3px);box-shadow:0 12px 32px var(--accent-soft);}

.offer-buttons {
  display:flex;gap:0.5rem;margin:1rem 0;flex-wrap:wrap;
}
.offer-btn {
  padding:0.6rem 1rem;background:#fff3cd;color:#856404;border:2px solid #ffc107;
  border-radius:12px;font-weight:700;cursor:pointer;transition:0.3s;font-size:0.85rem;
}
.offer-btn:hover {
  background:#ffc107;color:#fff;transform:translateY(-2px);
}

/* Popup */
.popup-overlay{
  position:fixed;inset:0;background:rgba(255,255,255,0.45);
  backdrop-filter:blur(24px);display:flex;justify-content:center;
  align-items:center;opacity:0;pointer-events:none;
  transition:0.3s;z-index:5000;padding:1rem;
}
.popup-overlay.active{opacity:1;pointer-events:all;}
.popup-card{
  width:92%;max-width:380px;background:#fff;border-radius:var(--radius);
  box-shadow:0 14px 56px rgba(0,0,0,0.08);
  padding:1.6rem;text-align:center;animation:pop 0.4s;
}
.popup-card h2{color:#567f63;font-weight:800;margin:0 0 0.5rem;font-size:1.5rem;}
.popup-card p{font-weight:700;color:var(--text-sub);margin-bottom:1.2rem;}

@keyframes pop{
  from{transform:scale(0.9);opacity:0;}to{transform:none;opacity:1;}
}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(28px);}to{opacity:1;transform:none;}
}
</style>
</head>

<body class="booking-page">
<nav>
 <div class="logo">‚ú¶ BookMyStay</div>
 <ul class="nav-links"><li><a href="index.html">Home</a></li></ul>
</nav>

<section class="booking-section">
<div class="booking-container">

  <!-- FORM -->
  <div class="booking-form-wrapper">
    <h1>Finalize Booking</h1>
    <form id="bookingForm" onsubmit="submitBook(event)">
      <label><i class="fa fa-user"></i> Full Name</label>
      <input type="text" id="fName" placeholder="Enter your name" required />

      <label><i class="fa fa-envelope"></i> Email</label>
      <input type="email" id="fEmail" placeholder="your@email.com" required />

      <label><i class="fa fa-phone"></i> Phone</label>
      <input type="tel" id="fPhone" placeholder="+91 1234567890" required />

      <label><i class="fa fa-map-marker-alt"></i> Address</label>
      <input type="text" id="fAddr" placeholder="Your address" required />

      <label><i class="fa fa-calendar-check"></i> Check In</label>
      <input type="date" id="cin" required />

      <label><i class="fa fa-calendar-times"></i> Check Out</label>
      <input type="date" id="cout" required />

      <label><i class="fa fa-users"></i> Number of Rooms</label>
      <select id="gst" required>
        <option value="">Select rooms</option>
        <option value="1">1 Room</option>
        <option value="2">2 Rooms</option>
        <option value="3">3 Rooms</option>
        <option value="4">4 Rooms</option>
        <option value="5">5 Rooms</option>
      </select>

      <label>Special Request (Optional)</label>
      <input type="text" id="req" placeholder="Any special requirements..." />

      <div style="margin:1.5rem 0;">
        <h3 style="margin-bottom:0.8rem;">üéÅ Apply Special Offers</h3>
        <div class="offer-buttons">
          <button type="button" class="offer-btn" onclick="applyOffer('percent', 20)">20% OFF</button>
          <button type="button" class="offer-btn" onclick="applyOffer('flat', 500)">‚Çπ500 OFF</button>
          <button type="button" class="offer-btn" onclick="applyOffer('percent', 30)">30% OFF</button>
        </div>
      </div>
    </form>
  </div>

  <!-- SUMMARY / BILL -->
  <div>
    <div class="booking-summary-card">
      <div class="booking-summary-title">Booking Summary</div>

      <div class="booking-summary-item"><span>Hotel</span><span id="bName">-</span></div>
      <div class="booking-summary-item"><span>Check-In</span><span id="bIn">-</span></div>
      <div class="booking-summary-item"><span>Check-Out</span><span id="bOut">-</span></div>
      <div class="booking-summary-item"><span>Nights</span><span id="bN">1</span></div>
      <div class="booking-summary-item"><span>Rooms</span><span id="bG">-</span></div>
      <div class="booking-summary-item"><span>Price/Night</span><span id="bFare">‚Çπ0</span></div>
      <div class="booking-summary-item"><span>Subtotal</span><span id="bSubtotal">‚Çπ0</span></div>
      <div class="booking-summary-item" id="discountRow" style="display:none;color:#4caf50;">
        <span>Discount</span><span id="bDiscount">-‚Çπ0</span>
      </div>
      <div class="booking-summary-item"><span>Tax (12%)</span><span id="bTax">‚Çπ0</span></div>

      <div class="booking-summary-total"><span>Total Payable</span><span id="bTotal">‚Çπ0</span></div>
    </div>

    <!-- PAYMENT -->
    <div class="payment-card" id="paymentSection">
      <div class="payment-title">Select Payment Method</div>

      <div class="pay-options">
        <div class="pay-btn" onclick="selectPay(this,'upi')"><i class="fa fa-qrcode"></i> UPI</div>
        <div class="pay-btn" onclick="selectPay(this,'card')"><i class="fa fa-credit-card"></i> Card</div>
        <div class="pay-btn" onclick="selectPay(this,'wallet')"><i class="fa fa-wallet"></i> Wallet</div>
        <div class="pay-btn" onclick="selectPay(this,'cod')"><i class="fa fa-building"></i> Pay at Hotel</div>
      </div>

      <button class="booking-btn-submit" onclick="payNow()">
        <i class="fas fa-lock"></i> Confirm & Pay
      </button>
    </div>
  </div>

</div>
</section>

<!-- POPUP -->
<div class="popup-overlay" id="pop">
 <div class="popup-card">
  <h2>‚úÖ Booking Confirmed!</h2>
  <p id="modalSubtitle">Your reservation has been successfully completed.</p>
  <p style="font-size:0.9rem;margin-top:1rem;">
    <strong>Booking ID:</strong> <span id="bookingId">BMS-XXX</span><br>
    <strong>Total Paid:</strong> <span id="totalPaid">‚Çπ0</span>
  </p>
  <button class="booking-btn-submit" onclick="closePop()">Back to Home</button>
 </div>
</div>

<script>
let pMode = "";
let discountAmount = 0;
let discountType = null;

// Calculate bill
function calc() {
  const h = JSON.parse(localStorage.getItem("hotel") || "{}");
  const r = JSON.parse(localStorage.getItem("room") || "{}");
  const fare = r.p || h.price || 0;

  document.getElementById("bName").textContent = h.name || "-";
  document.getElementById("bIn").textContent = cin.value || "-";
  document.getElementById("bOut").textContent = cout.value || "-";
  document.getElementById("bFare").textContent = "‚Çπ" + fare;

  if (cin.value && cout.value) {
    const n = Math.max(1, Math.ceil((new Date(cout.value) - new Date(cin.value)) / (86400000)));
    const rooms = parseInt(gst.value) || 1;
    
    document.getElementById("bN").textContent = n;
    document.getElementById("bG").textContent = rooms + " Room" + (rooms > 1 ? "s" : "");

    const subtotal = n * fare * rooms;
    document.getElementById("bSubtotal").textContent = "‚Çπ" + subtotal;

    // Apply discount
    let finalSubtotal = subtotal;
    if (discountAmount > 0) {
      if (discountType === 'percent') {
        discountAmount = Math.round((subtotal * discountAmount) / 100);
      }
      finalSubtotal = subtotal - discountAmount;
      document.getElementById("discountRow").style.display = "flex";
      document.getElementById("bDiscount").textContent = "-‚Çπ" + discountAmount;
    } else {
      document.getElementById("discountRow").style.display = "none";
    }

    const tax = Math.round(finalSubtotal * 0.12);
    const total = finalSubtotal + tax;
    
    document.getElementById("bTotal").textContent = "‚Çπ" + total;
    document.getElementById("bTax").textContent = "‚Çπ" + tax;
  }
}

// Apply offer
function applyOffer(type, value) {
  discountType = type;
  discountAmount = value;
  calc();
  
  const msg = type === 'percent' ? `${value}% discount applied!` : `‚Çπ${value} discount applied!`;
  alert("‚úÖ " + msg);
}

// Event listeners
cin.onchange = calc;
cout.onchange = calc;
gst.onchange = calc;

function submitBook(e) {
  e.preventDefault();
  
  if (!cin.value || !cout.value || !gst.value) {
    alert("‚ö†Ô∏è Please fill all required fields");
    return;
  }
  
  calc();
}

function selectPay(btn, m) {
  document.querySelectorAll('.pay-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  pMode = m;
}

function payNow() {
  if (!pMode) {
    alert("‚ö†Ô∏è Please select a payment method");
    return;
  }
  
  if (!cin.value || !cout.value || !gst.value) {
    alert("‚ö†Ô∏è Please fill all booking details");
    return;
  }
  
  // Generate booking ID
  const bookingId = "BMS" + Date.now();
  document.getElementById("bookingId").textContent = bookingId;
  document.getElementById("totalPaid").textContent = document.getElementById("bTotal").textContent;
  
  // Show confirmation popup
  document.getElementById("pop").classList.add("active");
}

function closePop() {
  document.getElementById("pop").classList.remove("active");
  window.location.href = "index.html";
}

// Initialize
window.onload = calc;

// Set minimum date to today
const today = new Date().toISOString().split('T')[0];
document.getElementById('cin').min = today;
document.getElementById('cout').min = today;
</script>

</body>
</html>